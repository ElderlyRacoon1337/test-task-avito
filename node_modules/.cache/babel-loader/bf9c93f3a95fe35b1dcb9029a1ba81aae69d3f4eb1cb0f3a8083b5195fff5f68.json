{"ast":null,"code":"import _slicedToArray from\"/Users/pavel/Documents/GitHub/test-task-avito/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useEffect,useState}from\"react\";import{Filters}from\"../../components/FIlters\";import{ThemeContext}from\"cutie-ui\";import{Items}from\"../../components/Items\";import{useAppDispatch,useAppSelector}from\"../../hooks\";import{setCurrentPage,setGamesData}from\"../../redux/slices/pagesSlice\";import{Status,getData,setLoadingStatus}from\"../../redux/slices/gamesSlice\";import{Pagination}from\"../../components/Pagination\";import{createPages}from\"../../utils/createPages\";import{toEngGenre}from\"../../utils/toEngGenre\";import{toEngPlatform}from\"../../utils/toEngPlatform\";import{toEngSortBy}from\"../../utils/toEngSortBy\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var MainPage=function MainPage(){var _data$;var dispatch=useAppDispatch();var data=useAppSelector(function(state){return state.games.data;});// ========================== Theme change =============================\n// const [theme, setTheme] = useState<\"dark\" | \"light\" | \"system\">(\"system\");\nvar theme=\"system\";var _useContext=useContext(ThemeContext),changeTheme=_useContext.changeTheme;useEffect(function(){changeTheme(theme);},[theme]);// =================================================================\nvar _useState=useState(\"Все платформы\"),_useState2=_slicedToArray(_useState,2),platform=_useState2[0],setPlatform=_useState2[1];var _useState3=useState(\"Все\"),_useState4=_slicedToArray(_useState3,2),genre=_useState4[0],setGenre=_useState4[1];var _useState5=useState(\"Релевантности\"),_useState6=_slicedToArray(_useState5,2),sortBy=_useState6[0],setSortBy=_useState6[1];useEffect(function(){var enSortBy=toEngSortBy(sortBy);var enPlatform=toEngPlatform(platform);var enGenre=toEngGenre(genre);dispatch(getData({sortBy:enSortBy,genre:enGenre,platform:enPlatform}));dispatch(setGamesData(data));dispatch(setCurrentPage(1));return function(){dispatch(setLoadingStatus(Status.LOADING));};},[platform,genre,sortBy]);// ========================== Pagination =============================\nvar _useAppSelector=useAppSelector(function(state){return state.pages;}),currentPage=_useAppSelector.currentPage,perPage=_useAppSelector.perPage;var totalCount=data.length;var pagesCount=Math.ceil(totalCount/perPage);var startIndex=(currentPage-1)*perPage;var endIndex=startIndex+perPage;var currentGames=data.slice(startIndex,endIndex);var pages=[];createPages(pages,pagesCount,currentPage);// =================================================================\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(Filters,{platform:platform,setPlatform:setPlatform,genre:genre,setGenre:setGenre,sortBy:sortBy,setSortBy:setSortBy}),/*#__PURE__*/_jsx(Items,{currentGames:currentGames}),(_data$=data[0])!==null&&_data$!==void 0&&_data$.title?/*#__PURE__*/_jsx(Pagination,{currentPage:currentPage,pages:pages,pagesCount:pagesCount}):\"\"]});};","map":{"version":3,"names":["useContext","useEffect","useState","Filters","ThemeContext","Items","useAppDispatch","useAppSelector","setCurrentPage","setGamesData","Status","getData","setLoadingStatus","Pagination","createPages","toEngGenre","toEngPlatform","toEngSortBy","jsx","_jsx","jsxs","_jsxs","MainPage","_data$","dispatch","data","state","games","theme","_useContext","changeTheme","_useState","_useState2","_slicedToArray","platform","setPlatform","_useState3","_useState4","genre","setGenre","_useState5","_useState6","sortBy","setSortBy","enSortBy","enPlatform","enGenre","LOADING","_useAppSelector","pages","currentPage","perPage","totalCount","length","pagesCount","Math","ceil","startIndex","endIndex","currentGames","slice","className","children","title"],"sources":["/Users/pavel/Documents/GitHub/test-task-avito/src/pages/MainPage/index.tsx"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\nimport { Filters } from \"../../components/FIlters\";\nimport { ThemeContext } from \"cutie-ui\";\nimport { Items } from \"../../components/Items\";\nimport { useAppDispatch, useAppSelector } from \"../../hooks\";\nimport { setCurrentPage, setGamesData } from \"../../redux/slices/pagesSlice\";\nimport {\n  Status,\n  getData,\n  setLoadingStatus,\n} from \"../../redux/slices/gamesSlice\";\nimport { Pagination } from \"../../components/Pagination\";\nimport { createPages } from \"../../utils/createPages\";\nimport { toEngGenre } from \"../../utils/toEngGenre\";\nimport { toEngPlatform } from \"../../utils/toEngPlatform\";\nimport { toEngSortBy } from \"../../utils/toEngSortBy\";\n\nexport const MainPage = () => {\n  const dispatch = useAppDispatch();\n  const data = useAppSelector((state) => state.games.data);\n\n  // ========================== Theme change =============================\n  // const [theme, setTheme] = useState<\"dark\" | \"light\" | \"system\">(\"system\");\n  const theme = \"system\";\n  const { changeTheme } = useContext(ThemeContext);\n  useEffect(() => {\n    changeTheme(theme);\n  }, [theme]);\n  // =================================================================\n\n  const [platform, setPlatform] = useState(\"Все платформы\");\n\n  const [genre, setGenre] = useState(\"Все\");\n\n  const [sortBy, setSortBy] = useState(\"Релевантности\");\n\n  useEffect(() => {\n    const enSortBy = toEngSortBy(sortBy);\n    const enPlatform = toEngPlatform(platform);\n    const enGenre = toEngGenre(genre);\n\n    dispatch(\n      getData({ sortBy: enSortBy, genre: enGenre, platform: enPlatform })\n    );\n\n    dispatch(setGamesData(data));\n    dispatch(setCurrentPage(1));\n\n    return () => {\n      dispatch(setLoadingStatus(Status.LOADING));\n    };\n  }, [platform, genre, sortBy]);\n\n  // ========================== Pagination =============================\n  const { currentPage, perPage } = useAppSelector((state) => state.pages);\n  const totalCount = data.length;\n  const pagesCount = Math.ceil(totalCount / perPage);\n  const startIndex = (currentPage - 1) * perPage;\n  const endIndex = startIndex + perPage;\n  const currentGames = data.slice(startIndex, endIndex);\n\n  const pages: number[] = [];\n  createPages(pages, pagesCount, currentPage);\n  // =================================================================\n\n  return (\n    <div className=\"container\">\n      <Filters\n        platform={platform}\n        setPlatform={setPlatform}\n        genre={genre}\n        setGenre={setGenre}\n        sortBy={sortBy}\n        setSortBy={setSortBy}\n      />\n      <Items currentGames={currentGames} />\n      {data[0]?.title ? (\n        <Pagination\n          currentPage={currentPage}\n          pages={pages}\n          pagesCount={pagesCount}\n        />\n      ) : (\n        \"\"\n      )}\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}